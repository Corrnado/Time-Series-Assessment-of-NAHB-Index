---
title: "Time Series Assessment of NAHB Index"
output:
  html_document:
    df_print: paged
---

All data was downloaded from website "https://www.nahb.org/en/research/housing-economics/housing-indexes/housing-market-index.aspx". The naitonal NAHB index history data from Jan 2000 to Feb 2018 was converted to csv file in Excel.

```{r}
# import history data from the file and convert the data into time series object
nhist <- read.csv("national_history.csv", header = TRUE)
nhistts <- ts(nhist[,2], frequency = 12, start = c(2000,1), end = c(2018,2))

# get a sense of what the data looks like
plot(nhistts)
hist(nhistts)
summary(nhistts)
nhisttscomp <- decompose(nhistts)
plot(nhisttscomp)
```

NAHB varies from 9 to 74 in the past and most of the time the index falled into 10-20 and 50-70 interval, which should be related to the 2008 finanacial crisis. After decomposign the data, it is shown that there should be a seasonal pattern in the data and there is a rapid drop from 2008. 

```{r}
# to select a time series model using cross validation due to the continuous requirement 
# of time series model, a rolling basis cross validation will be implented

# to create a group identifier for each year andthe 2 monthes in 2018 will be combined with 2017
id <- rep(1:18, each = 12)
id <- c(id, c(18, 18))

# to create one numeric vector for storing mae value and one list for ARIMA parameters
models <- vector("list", 17)
maes <- vector("numeric", 17)

# loop through every traning group
for (i in 2:17){
  nhisttsforecast <- auto.arima(window(nhistts, 1, c(i, 12)), D = 1, trace = TRUE)
  models[[i]] <- nhisttsforecast$arma
  if (i < 14){
    pred <- forecast(nhisttsforecast, 12)
  } else {
    pred <- forecast(nhisttsforecast, 14)
  }
  maes[i] <- mean(abs(pred$mean - nhistts[id == i + 1]))
}

# using mae criterion for the best fitting model
models[[which.min(maes[2:14]) + 1]]
```

Since time series model requires a continuous 